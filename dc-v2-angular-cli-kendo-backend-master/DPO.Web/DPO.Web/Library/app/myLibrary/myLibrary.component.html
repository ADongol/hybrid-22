<library-popup #Librarypopup>
  <loader *ngIf="showLoader"></loader>
  <div *ngIf="!showLoader">
    <div class="mylibrary-btn-wrap">
      <a class="btn btn-mylibrary" *ngIf="userInfo?.Email" [ngClass]="{'active':(DataInPopup=='myLibrary')} " (click)="popupData('myLibrary')">My Library ({{!myLibrary?0:myLibrary.length}})</a>
      <a class="btn btn-queue" [ngClass]="{'active':(DataInPopup=='downloadQueue')} " (click)="popupData('downloadQueue')">Download Queue ({{!downloadQueue?0:downloadQueue.length}})</a>
    </div>
    <div class="popupScroll">
      <div *ngIf="DataInPopup == 'myLibrary'">
        <div class="lib-popup-title">
          <button type="button" class="close" (click)="closeMylibrary();"><img src="./assets/images/close.png"> Close</button>
          <h2>My Library ({{myLibrary.length}})</h2>
        </div>
        <p class="library-decsription">Here you can view documents that you have previously bookmarked.</p>
        <library-search-section class="library-popup" [advanceCheckboxes]="false" (dropdownValues)="dropdownValues($event)" (searchTermEmit)="searchTermEmit($event)"
          [currentUserInfo]="userInfo"></library-search-section>
        <div *ngIf="myLibrary?.length == 0 && showArchived==false" class="lib-popup-title">
          <h2>{{noResultMessage}}</h2>
        </div>
        <div *ngIf="myLibrary?.length == 0 && showArchived==true" class="lib-popup-title">
          <h2>No Items are Archived</h2>
        </div>
        <div class="row">
          <div class="col-xs-12 col-sm-12 col-md-12 no-padding popup-sort-filter last-section">
            <div class="col-xs-4 col-sm-4 col-md-4">
              <div class="checkbox-wrap custom-checkbox">
                <label class="checkbox checkbox--material">
            <input type="checkbox" class="checkbox__input checkbox--material__input" (change)="getArchived($event.target.checked)"  name="DocContent" value="">
            <div class="checkbox__checkmark checkbox--material__checkmark"></div>
            <span class="all">Archived</span>
          </label>
              </div>
            </div>
            <div class="col-xs-8 col-sm-8 col-md-8 text-right">
              <div class="col-xs-6 col-sm-6 col-md-8">
                <h4>Sort Results By</h4>
              </div>
              <div class="col-xs-6 col-sm-6 col-md-4 no-padding pull-right">
                <div class="select-btn">
                  <ng-select [items]="filterItems" (data)="setFilterSelection($event)" [(ngModel)]="selectedSorting" name="filter" (ngModelChange)="sortOnChange($event)"
                    placeholder="Date"></ng-select>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="myLibrary?.length != 0" class="col-xs-12 col-sm-12 col-md-12 ">
            <div class="mylibrary-popup-list">
              <ul class="list-group">
                <li class="head-row">
                  <div class="border-grey">
                    <div class="checkbox-wrap custom-checkbox">
                      <div class="checkbox-grid">
                        <label class="checkbox checkbox--material">
                  <input type="checkbox" class="checkbox__input checkbox--material__input" [checked]="isAllChecked('myLibrary')" (change)="checkAll($event,'myLibrary')"  name="DocContent" value="">
                  <div class="checkbox__checkmark checkbox--material__checkmark"></div>
                </label>
                      </div>
                    </div>
                    <div class="model-series-wrap">
                      <span class="hd-for-section">Document</span>
                    </div>
                  </div>
                </li>
                <li *ngFor="let item of myLibrary | fuzzySearch:searchTerm|sortBy:sortTerm|slice:(page-1)*limit:page*limit" class="list-group-item">
                  <div>
                    <div class="border-grey">
                      <div class="checkbox-wrap custom-checkbox">
                        <div class="checkbox-grid">
                          <label class="checkbox checkbox--material">
                <input type="checkbox" class="checkbox__input checkbox--material__input" [(ngModel)]="item.state" (change)="addToQueue(item,$event.target.checked)" name="DocContent" value="">
                <div class="checkbox__checkmark checkbox--material__checkmark"></div></label>
                        </div>
                      </div>
                      <div class="model-series-wrap">
                        <div class="model-series-number" (click)="showPreview(item)">{{item.DocTitle}}</div>
                        <div class="model-series-title">{{item.ProductSeries}}</div>
                        <div class="model-series-breadcrumb">{{item.ProductCategory}} > {{item.DocumentType}}</div>
                      </div>
                    </div>
                    <div class="document-action-wrap">
                      <div class="document-actions">
                        <span class="document-action-btns">
                      <span (click)="addOrRemoveToLibrary(item,'remove')" popover="Remove from my Library" placement="bottom" triggers="mouseenter:mouseleave"
                        class="bookmark-active-icon"> 
              <img src="./assets/images/bookmark_active.png" /> 
            </span>
                        <span [ngClass]="{'no-popover': item?.WebLink}" class="download-icon" popover="Download Now" placement="bottom" triggers="mouseenter:mouseleave"> 
              <a  [ngClass]="{'disabled': item?.WebLink} "  (click)="item.WebLink?'':downloadFile(item)"><img src="./assets/images/download.png" /> </a>
            </span>
                        <span (click)="copyToClipBoard(item.DocURL)" popover="Copy Link" placement="bottom" triggers="mouseenter:mouseleave" class="arrow-icon"> 
              <img src="./assets/images/arrow.png" /> 
            </span>
                        </span>
                        <input [disabled]="item?.WebLink" *ngIf="!item.inDownloadQueue" (click)="addToDownloadQueue(item,true)" class="btn-primary black-button add-doc-btn"
                          type="button" value="Add to Download Queue">
                        <input [disabled]="item?.WebLink" *ngIf="item.inDownloadQueue" (click)="addToDownloadQueue(item,false)" class="btn-primary remove-doc-btn"
                          value="Remove From Download Queue">
                      </div>
                      <div class="published-date ">
                        <span class="date-size-wrap">
            <span class="date-size-wrap-inner">
             <span>Published: {{item.PublishedDate| date: 'MM/dd/yyyy'}}</span>
                        <span [ngClass]="{'no-docSize': !item.DocSize}" class="doc-size">File Size: {{item.DocSize|convertFileSize}}</span>
                        </span>
                        </span>
                      </div>
                    </div>
                  </div>
                </li>
              </ul>
            </div>
          </div>
          <div *ngIf="myLibrary?.length != 0" class="col-xs-12 col-sm-12 col-md-12 views-document-buttons">
            <a [ngClass]="{'disabled': weblinkInQueue||queue?.length==0}"  class="black-button" (click)="addAllToDownloadQueue()">Add to Download Queue ({{queue.length}})</a>
          </div>
        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 no-padding" *ngIf="myLibrary?.length != 0">
          <ul class="pagination">
            <li><a aria-label="Previous" (click)="previous();" class="previous" [ngClass]="{'disabled':(page==1)}"> <span aria-hidden="true" class="ad-left"></span> </a></li>
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"> Page {{page}} of {{ totalPage}} <span class="ads-arw-down"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li *ngFor="let item of noOfItemArray" (click)="goToPageNo(item)">Page {{item.totalNoOfPages}}</li>
              </ul>
            </li>
            <li><a aria-label="Next" class="next" [ngClass]="{'disabled':(page==totalPage)}" (click)="next();"> <span aria-hidden="true" class="ad-right"></span> </a></li>
          </ul>
        </div>
      </div>
      <div *ngIf="DataInPopup=='downloadQueue'">
        <div class="lib-popup-title">
          <button type="button" class="close" (click)="closeMylibrary();"><img src="./assets/images/close.png"> Close</button>
          <h2>My Download Queue ({{downloadQueue.length}})</h2>
        </div>

        <p class="d-que-decsription">Download multiple documents at a time into a single zipped file.</p>
        <p class="note-text">*Please note that these documents will not remain saved in your download queue after youâ€™ve logged out of each session.</p>
        <library-search-section [advanceCheckboxes]="false" class="download-popup" (dropdownValues)="dropdownValues($event)" (searchTermEmit)="searchTermEmit($event)"
          [currentUserInfo]="userInfo"></library-search-section>
        <div *ngIf="downloadQueue?.length == 0" class="lib-popup-title">
          <h2>{{noResultMessage}}</h2>
        </div>
        <div *ngIf="downloadQueue?.length != 0" class="row">
          <div class="col-xs-12 col-sm-12 col-md-12 no-padding popup-sort-filter last-section download-queue">
            <div class="col-xs-4 col-sm-4 col-md-4">
              <div class="checkbox-wrap custom-checkbox">
              </div>
            </div>
            <div class="col-xs-8 col-sm-8 col-md-8 text-right">
              <div class="col-xs-6 col-sm-6 col-md-8">
                <h4>Sort Results By</h4>
              </div>
              <div class="col-xs-6 col-sm-6 col-md-4 no-padding pull-right">
                <div class="select-btn">
                  <ng-select [items]="filterItems" [(ngModel)]="selectedSorting" name="filter" (ngModelChange)="sortOnChange($event)" placeholder="Date"></ng-select>
                </div>
              </div>
            </div>
          </div>

          <div *ngIf="downloadQueue?.length != 0" class="col-xs-12 col-sm-12 col-md-12 ">
            <div class="mylibrary-popup-list">
              <ul class="list-group">
                <li class="head-row">
                  <div class="border-grey">
                    <div class="checkbox-wrap custom-checkbox">
                      <div class="checkbox-grid">
                        <label class="checkbox checkbox--material">
                        <input type="checkbox" class="checkbox__input checkbox--material__input" [checked]="isAllChecked('downloadQueue')" (change)="checkAll($event,'downloadQueue')"   name="DocContent" value="">
                        <div class="checkbox__checkmark checkbox--material__checkmark"></div>
                      </label>
                      </div>
                    </div>
                    <div class="model-series-wrap">
                      <span class="hd-for-section">Document</span>
                    </div>
                  </div>
                </li>
                <!-- <li *ngFor="let item of downloadQueue | fuzzySearch:searchTerm" class="list-group-item"> -->
                <li *ngFor="let item of downloadQueue | fuzzySearch:searchTerm | sortBy:sortTerm | slice:(page-1)*limit:page*limit" class="list-group-item">
                  <div class="border-grey">
                    <div class="checkbox-wrap custom-checkbox">
                      <div class="checkbox-grid">
                        <label class="checkbox checkbox--material">
                      <input type="checkbox" class="checkbox__input checkbox--material__input" [(ngModel)]="item.state" (change)="addToQueue(item,$event.target.checked)" name="DocContent" value="">
                      <div class="checkbox__checkmark checkbox--material__checkmark"></div></label>
                      </div>
                    </div>
                    <div class="model-series-wrap">
                      <div class="model-series-number" (click)="showPreview(item)">{{item.DocTitle}}</div>
                      <div class="model-series-title">{{item.ProductSeries}}</div>
                      <div class="model-series-breadcrumb">{{item.ProductCategory}} > {{item.DocumentType}}</div>
                    </div>
                  </div>
                  <div class="document-action-wrap">
                    <div class="document-section">
                      <div class="document-actions">
                        <span class="document-action-btns">
                      <span  *ngIf="!item.isInMylibrary" (click)="addOrRemoveToLibrary(item,'add')" popover="Add to Library" placement="bottom" triggers="mouseenter:mouseleave" class="bookmark-icon"> 
                        <img src="./assets/images/bookmark.png" /> 
                      </span>

                        <span *ngIf="item.isInMylibrary" (click)="addOrRemoveToLibrary(item,'remove')" popover="Remove from my Library" placement="bottom"
                          triggers="mouseenter:mouseleave" class="bookmark-active-icon"> 
                      <img src="./assets/images/bookmark_active.png" /> 
                    </span>

                        <span [ngClass]="{'no-popover': item?.WebLink}" popover="Download Now" placement="bottom" triggers="mouseenter:mouseleave"
                          class="download-icon"> 
                      <a [ngClass]="{'disabled': item?.WebLink} " (click)="item.WebLink?'':downloadFile(item)"><img src="./assets/images/download.png" /> </a>
                    </span>
                        <span (click)="copyToClipBoard(item.DocURL)" popover="Copy Link" placement="bottom" triggers="mouseenter:mouseleave" class="arrow-icon"> 
                      <img src="./assets/images/arrow.png" /> 
                    </span>

                        </span>
                        <!-- <input [disabled]="item?.WebLink" class="btn-primary black-button add-doc-btn hidden" type="button" value="Add to Download Queue"> -->
                        <input [disabled]="item?.WebLink" class="btn-primary remove-doc-btn" (click)="addToDownloadQueue(item,false)" type="button"
                          value="Remove From Download Queue">
                      </div>
                      <div class="published-date">
                        <span class="date-size-wrap">
                    <span class="date-size-wrap-inner">
                     <span>Published: {{item.PublishedDate| date: 'MM/dd/yyyy'}} </span>
                        <span [ngClass]="{'no-docSize': !item.DocSize}" class="doc-size">File Size: {{item.DocSize |convertFileSize}}</span>
                        </span>
                        </span>
                      </div>
                    </div>
                  </div>
                </li>
              </ul>
            </div>
          </div>
          <div class="col-xs-12 col-sm-12 col-md-12 views-document-buttons">
            <a class="black-button" (click)="downloadSelected()">Download ({{queue.length}})</a>
          </div>
        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 no-padding" *ngIf="downloadQueue?.length !== 0">
          <ul class="pagination">
            <li><a aria-label="Previous" (click)="previous();" class="previous" [ngClass]="{'disabled':(page==1)}"> <span aria-hidden="true" class="ad-left"></span> </a></li>
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"> Page {{page}} of {{ totalPage}} <span class="ads-arw-down"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li *ngFor="let item of noOfItemArray" (click)="goToPageNo(item)">Page {{item.totalNoOfPages}}</li>
              </ul>
            </li>
            <li><a aria-label="Next" class="next" [ngClass]="{'disabled':(page==totalPage)}" (click)="next();"> <span aria-hidden="true" class="ad-right"></span> </a></li>
          </ul>
        </div>
      </div>
    </div>
    <div id="popupAlert">{{alertMessage}}</div>
    <!-- <button type="button" class="btn btn-primary" >Static modal</button> -->
    <div class="modal fade iframe-popup" bsModal #staticModal="bs-modal" [config]="{backdrop: 'static'}" tabindex="-1" role="dialog"
      aria-labelledby="mySmallModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-md">
        <div class="modal-content">
          <div class="modal-header">
            <div class="container-fluid preview">
              <div class="row">
                <div class="col-md-10 col-sm-9">
                  <div class="border-grey">
                    <div class="model-series-wrap">
                      <div class="model-series-number">{{previewData.DocTitle}}</div>
                    </div>
                  </div>
                </div>
                <div class="col-md-2 col-sm-3">
                  <div class="close-wrap">
                    <button type="button" class="close" aria-label="Close" (click)="staticModal.hide()">
            <span aria-hidden="true" (click)="closePreview();">
              <img src="./assets/images/close.png"> Close</span>
            </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-body file-download">
            <div *ngIf="previewData.noPreview" class="text-center">
              <h4 class="no-preview-text">The preview for the following document is currently not available. Please use the Download option below.
              </h4>
              <a (click)="previewData.WebLink?'':downloadFile(previewData)"> <span class="download-icon" popover="Download now" placement="top" triggers="mouseenter:mouseleave" placement="bottom"> 
                <img src="./assets/images/download.png" /></span></a>
            </div>
            <div *ngIf="previewData.showImg" class="preview-img-wrap">
              <img src="{{previewSrc}}">
            </div>
            <div>
              <videojs *ngFor="let video of videos; let idx = index" [idx]="idx" [url]="video"></videojs>
            </div>
            <div *ngIf="previewData.showIframe">
              <iframe width="100%" height="600" [src]="previewSrc | safe"></iframe>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- <button type="button" class="btn btn-primary" >Static modal</button> -->
    <div class="modal fade downloadPopup" bsModal #downloadPopup="bs-modal" [config]="{backdrop: 'static'}" tabindex="-1" role="dialog"
      aria-labelledby="mySmallModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-md">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close pull-right" aria-label="Close" (click)="downloadPopup.hide()">
  <span aria-hidden="true" (click)="closeDownloadPopup();">
    <img src="./assets/images/close.png"> Close</span>
  </button>
          </div>
          <div class="modal-body">
            <h3 class="download-hd">Image Download Size</h3>
            <p class="dwnload-text">The files you have selected to download contain images. Select image download size.</p>
            <div class="select-wrap form-inline">
              <div class="form-group">
                <label>Image Size</label>
                <div class="select-btn">
                  <select class="sortDropDown form-control" (change)="updateFileSize()" [(ngModel)]="ImageSize">
          <option *ngFor="let n of imageSizeOptions" [attr.value]="n">{{n}}</option>
        </select>
                </div>
              </div>
            </div>
            <div class="btn-foot-wrap">
              <div class="row">
                <div class="col-md-offset-3 col-md-9 col-sm-offset-3 col-sm-9">
                  <div class="pull-right">
                    <span class="file-size">File Size: {{downloadSize}}</span>
                    <button *ngIf="zipDownload" type="button" class="btn black-button" (click)="downloadQueueSelected()">
          Download ({{queue.length}})
        </button>
                    <button *ngIf="!zipDownload" type="button" class="btn black-button" (click)="downloadImageFile()">
          Download 
        </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</library-popup>